# 项目结构说明

## 目录结构

```
SmartCutElf/
├── README.md                    # 项目说明
├── requirements.txt             # Python依赖
├── config.yaml                  # 配置文件
├── main.py                      # 程序入口
├── 启动.bat                     # 快速启动
├── 快速打包.bat                 # 快速打包
│
├── src/                         # 源代码
│   ├── core/                    # 核心功能
│   │   ├── audio_analyzer.py   # 音频分析
│   │   ├── video_analyzer.py   # 视频分析
│   │   ├── video_processor.py  # 视频处理
│   │   ├── highlight_detector.py # 高光检测
│   │   ├── workflow.py         # 工作流引擎
│   │   └── transition_effects.py # 转场效果
│   │
│   ├── ai/                      # AI功能
│   │   ├── speech_recognition.py # 语音识别
│   │   ├── subtitle_generator.py # 字幕生成
│   │   └── text_to_speech.py    # 文本转语音（未使用）
│   │
│   ├── ui/                      # 用户界面
│   │   ├── main_window.py      # 主窗口
│   │   ├── settings_dialog.py  # 设置对话框
│   │   ├── theme_manager.py    # 主题管理
│   │   └── enhanced_widgets.py # 增强控件
│   │
│   └── utils/                   # 工具模块
│       ├── logger.py           # 日志系统
│       ├── config.py           # 配置管理
│       ├── database.py         # 数据库
│       ├── file_manager.py     # 文件管理
│       ├── performance.py      # 性能监控
│       └── ...
│
├── scripts/                     # 脚本文件
│   ├── build.py                # 打包脚本
│   └── clear_cache.bat         # 清理缓存
│
├── docs/                        # 文档
│   ├── README.md               # 文档索引
│   ├── 依赖优化说明.md         # 依赖管理
│   ├── 打包优化说明.md         # 打包指南
│   ├── 问题修复记录.md         # 问题解决
│   ├── 项目结构说明.md         # 本文件
│   └── ...
│
├── assets/                      # 资源文件
│   └── app_icon.ico            # 应用图标
│
├── data/                        # 数据文件（gitignore）
│   └── smartcutelf.db          # 数据库
│
├── logs/                        # 日志文件（gitignore）
├── build/                       # 构建临时文件（gitignore）
└── dist/                        # 打包输出（gitignore）
```

## 核心文件说明

### 根目录

| 文件 | 说明 |
|------|------|
| `README.md` | 项目主文档 |
| `requirements.txt` | Python依赖列表 |
| `config.yaml` | 应用配置文件 |
| `main.py` | 程序入口 |
| `启动.bat` | 快速启动脚本 |
| `快速打包.bat` | 快速打包脚本 |

### src/ 源代码

#### core/ 核心功能
- **audio_analyzer.py** - 音频分析（音量、静音检测）
- **video_analyzer.py** - 视频分析（场景变化）
- **video_processor.py** - 视频处理（FFmpeg封装）
- **highlight_detector.py** - 高光检测（综合分析）
- **workflow.py** - 工作流引擎（整合所有模块）
- **transition_effects.py** - 转场效果

#### ai/ AI功能
- **speech_recognition.py** - 语音识别（Whisper）
- **subtitle_generator.py** - 字幕生成（SRT）
- **text_to_speech.py** - 文本转语音（未使用）

#### ui/ 用户界面
- **main_window.py** - 主窗口（PyQt5）
- **settings_dialog.py** - 设置对话框
- **theme_manager.py** - 主题管理
- **enhanced_widgets.py** - 增强控件

#### utils/ 工具模块
- **logger.py** - 日志系统
- **config.py** - 配置管理
- **database.py** - 数据库（SQLite）
- **file_manager.py** - 文件管理
- **performance.py** - 性能监控

### scripts/ 脚本

| 文件 | 说明 |
|------|------|
| `build.py` | 打包脚本（约40秒） |
| `clear_cache.bat` | 清理缓存脚本 |

### docs/ 文档

| 文件 | 说明 |
|------|------|
| `README.md` | 文档索引 |
| `依赖优化说明.md` | 依赖管理和优化 |
| `打包优化说明.md` | 打包指南 |
| `问题修复记录.md` | 常见问题解决 |
| `项目结构说明.md` | 本文件 |

## 数据目录

### data/ 数据文件（不提交到git）
- `smartcutelf.db` - SQLite数据库

### logs/ 日志文件（不提交到git）
- 运行时日志

### build/ 构建临时文件（不提交到git）
- PyInstaller构建缓存

### dist/ 打包输出（不提交到git）
- 打包后的可执行文件

## 配置文件

### config.yaml
应用配置文件，包含：
- 视频处理参数
- 高光检测权重
- AI功能设置
- 输出格式配置

### .gitignore
Git忽略规则，包含：
- Python缓存文件
- 构建和打包文件
- 日志和数据文件
- IDE配置文件

## 依赖管理

### requirements.txt
核心依赖：
- numpy - 数组计算
- opencv-python - 视频处理
- scipy - 音频信号处理
- PyQt5 - GUI界面
- pyyaml - 配置文件
- psutil - 性能监控
- openai-whisper - 语音识别

## 开发工作流

### 1. 开发
```bash
# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

### 2. 测试
```bash
# 处理测试视频
# 检查日志文件
```

### 3. 打包
```bash
# 快速打包
快速打包.bat

# 或命令行
python scripts\build.py
```

### 4. 发布
```bash
# 输出在 dist/SmartCutElf/
# 压缩后分发
```

## 文件命名规范

- Python文件：小写+下划线（snake_case）
- 类名：大驼峰（PascalCase）
- 函数/变量：小写+下划线（snake_case）
- 常量：大写+下划线（UPPER_CASE）
- 批处理文件：中文描述性名称

## 目录整理原则

1. **根目录简洁** - 只保留必要的配置和启动文件
2. **功能分类** - 代码、脚本、文档、数据分开存放
3. **忽略临时文件** - build/、dist/、logs/、data/ 不提交
4. **文档集中** - 所有文档放在 docs/ 目录
5. **脚本独立** - 打包和工具脚本放在 scripts/ 目录
