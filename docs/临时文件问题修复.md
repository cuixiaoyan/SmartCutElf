# 临时文件问题修复

## 问题

临时音频文件保存在视频目录导致权限问题和文件名冲突。

## 解决方案

### 1. 使用系统临时目录

```python
# 修改前
temp_audio_path = Path(video_path).parent / "temp_audio.wav"

# 修改后
temp_manager = get_temp_manager()
temp_audio_path = temp_manager.create_unique_temp_file(
    prefix=f"{video_name}_",
    suffix=".wav",
    subdir="temp_audio"
)
```

### 2. 临时文件管理器

**文件：** `src/utils/temp_file_manager.py`

**功能：**
- 创建唯一临时文件
- 自动清理过期文件
- 统计空间占用

**使用：**
```python
from utils.temp_file_manager import get_temp_manager, cleanup_old_temp_files

# 清理超过24小时的文件
cleanup_old_temp_files(hours=24)

# 查看信息
manager = get_temp_manager()
print(manager.get_temp_info())
```

### 3. 临时文件位置

**Windows:** `C:\Users\{用户}\AppData\Local\Temp\SmartCutElf\temp_audio\`
**Linux/Mac:** `/tmp/SmartCutElf/temp_audio/`

## 清理建议

```python
# 启动时清理（main.py）
cleanup_old_temp_files(hours=24)

# 处理完成后清理
manager.clean_temp_files(subdir="temp_audio")
```
